### Set-up

#### Load necessary packages

```{r}
#| label: modeling-sol-set-up
#| message: false
#| warning: false
library(tidyverse)
library(survey)
library(srvyr)
library(srvyrexploR)
library(broom)
library(gt)
```

#### Load in data and preview it

```{r}
#| label: modeling-sol-data-summary
glimpse(anes_2024)
```

Find codebook here: [ANES 2024](https://tidy-survey-r.github.io/srvyrexploR/reference/anes_2024.html)

#### Create design objects for usage

```{r}
#| label: modeling-sol-design-obj
anes_des <- anes_2024 %>%
  filter(InterviewMode_Pre != "3. Paper (PAPI)") %>% 
  mutate(Weight = V240108b / sum(V240108b) * 232449541) %>%
  as_survey_design(
    weights = Weight,
    strata = V240108d,
    ids = V240108c,
    nest = TRUE
  )
```

### Exercises

1. Build a logistic model predicting early voting in 2024 (`EarlyVote`) using campaign interest (`CampaignInterest`).

```{r}
#| label: modeling-sol-1
earlyvote_mod <- anes_des %>%
  filter(!is.na(EarlyVote)) %>%
  svyglm(
    design = .,
    formula = EarlyVote ~ CampaignInterest,
    family = quasibinomial
  )

tidy(earlyvote_mod) %>% print(n = 50)
```

2. Build a logistic model predicting early voting in 2024 (`EarlyVote`) using campaign interest (`CampaignInterest`) and whether they voted in 2020 (`VotedPres2020`). Include two-way interactions.

```{r}
#| label: modeling-sol-2
earlyvote_mod <- anes_des %>%
  filter(!is.na(EarlyVote)) %>%
  svyglm(
    design = .,
    formula = EarlyVote ~ (CampaignInterest + VotedPres2020)^2,
    family = quasibinomial
  )

tidy(earlyvote_mod) %>% print(n = 50)
```
