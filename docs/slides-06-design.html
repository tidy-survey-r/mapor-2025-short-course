<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.15">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>slides-06-design</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./images/favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-4576267147431a310ec27e40e99ae70b.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-1f6f300e52c19a3a756e2427acbf95f7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body>

<div id="quarto-search-results"></div>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<section id="sampling-designs-in-srvyr" class="level1" data-background-color="#087e8b">
<h1 data-background-color="#087e8b">Sampling designs in {srvyr}</h1>
<section id="sampling-methods" class="level2">
<h2 class="anchored" data-anchor-id="sampling-methods">Sampling methods</h2>
<p>Units can be selected in various ways such as:</p>
<ul>
<li><p><strong>Simple random sampling (with or without replacement):</strong> every unit has the same chance of being selected</p></li>
<li><p><strong>Systematic sampling:</strong> sample individuals from an ordered list and sampling individuals at an interval with a random starting point</p></li>
<li><p><strong>Probability proportional to size:</strong> probability of selection is proportional to “size”</p></li>
</ul>
</section>
<section id="complex-designs" class="level2">
<h2 class="anchored" data-anchor-id="complex-designs">Complex designs</h2>
<p>Designs can also incorporate stratification and/or clustering:</p>
<ul>
<li><p><strong>Stratified sampling:</strong> divide population into mutually exclusive subgroups (strata). Randomly sample within each stratum</p></li>
<li><p><strong>Clustered sampling:</strong> divide population into mutually exclusive subgroups (clusters). Randomly sample clusters and then individuals within clusters</p></li>
</ul>
</section>
<section id="why-design-matters" class="level2">
<h2 class="anchored" data-anchor-id="why-design-matters">Why design matters?</h2>
<ul>
<li><p>The design type impacts the variability of the estimates</p></li>
<li><p>Weights impact the point estimate and the variability estimates</p></li>
<li><p>Specifying the components of the design (strata and/or clusters) and weights in R is necessary to get correct estimates</p></li>
</ul>
</section>
<section id="determining-the-design" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="determining-the-design">Determining the design</h2>
<div class="incremental">
<ul class="incremental">
<li><p>Check the documentation such as methodology, design, analysis guide, or technical documentation</p></li>
<li><p>Documentation will indicate the variables needed to specify the design. Look for:</p>
<ul class="incremental">
<li>weight (almost always)</li>
<li>strata and/or clusters/PSUs. Sometimes pseudo-strata and pseudo-cluster OR</li>
<li>replicate weights (this is used instead of strata/clusters for analysis)</li>
<li>Finite population correction or population sizes (uncommon)</li>
</ul></li>
<li><p>Documentation may include SAS, SUDAAN, Stata and/or R syntax</p></li>
</ul>
</div>
<div class="notes">
<ul>
<li>We will show both ANES and RECS examples when diving into code</li>
</ul>
</div>
</section>
</section>
<section id="designs-without-replicate-weights" class="level1 page-columns page-full" data-background-color="#087e8b">
<h1 data-background-color="#087e8b">Designs <em>without</em> replicate weights</h1>
<section id="as_survey_design-syntax" class="level2">
<h2 class="anchored" data-anchor-id="as_survey_design-syntax"><code>as_survey_design()</code>: Syntax</h2>
<ul>
<li><p>Specifying the sampling design when you don’t have replicate weights</p></li>
<li><p><code>as_survey_design()</code> creates a <code>tbl_svy</code> object that then correctly calculates weighted estimates and SEs</p></li>
</ul>
<p>. . .</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">as_survey_design</span>(</span>
<span id="cb1-2"><a href="#cb1-2"></a>  .data,</span>
<span id="cb1-3"><a href="#cb1-3"></a>  <span class="at">ids =</span> <span class="cn">NULL</span>, <span class="co"># cluster IDs/PSUs</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="at">strata =</span> <span class="cn">NULL</span>, <span class="co"># strata variables</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="at">variables =</span> <span class="cn">NULL</span>, <span class="co"># defaults to all in .data</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>  <span class="at">fpc =</span> <span class="cn">NULL</span>, <span class="co"># variables defining the fpc</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>  <span class="at">nest =</span> <span class="cn">FALSE</span>, <span class="co"># TRUE/FALSE - relabel clusters to nest within strata</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>  <span class="at">check_strata =</span> <span class="sc">!</span>nest, <span class="co"># check that clusters are nested in strata</span></span>
<span id="cb1-9"><a href="#cb1-9"></a>  <span class="at">weights =</span> <span class="cn">NULL</span> <span class="co"># weight variable,</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="syntax-for-common-designs" class="level2 smaller page-columns page-full">
<h2 class="smaller anchored" data-anchor-id="syntax-for-common-designs">Syntax for common designs</h2>
<p>Load in the example data from {survey} package:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(api, <span class="at">package=</span><span class="st">"survey"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>. . .</p>
<p>Simple Random Sample (SRS)</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>apisrs <span class="sc">%&gt;%</span> <span class="fu">as_survey_design</span>(<span class="at">fpc =</span> fpc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>. . .</p>
<p>Stratified SRS</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>apistrat <span class="sc">%&gt;%</span> <span class="fu">as_survey_design</span>(<span class="at">strata =</span> stype, <span class="at">weights =</span> pw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>. . .</p>
<p>One-stage cluster sample with a FPC variable</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>apiclus1 <span class="sc">%&gt;%</span> <span class="fu">as_survey_design</span>(<span class="at">ids =</span> dnum, <span class="at">weights =</span> pw, <span class="at">fpc =</span> fpc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>. . .</p>
<p>Two-stage cluster sample, weights computed from population size</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>apiclus2 <span class="sc">%&gt;%</span> <span class="fu">as_survey_design</span>(<span class="at">ids =</span> <span class="fu">c</span>(dnum, snum), <span class="at">fpc =</span> <span class="fu">c</span>(fpc1, fpc2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>. . .</p>
<p>Stratified, cluster design</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>apistrat <span class="sc">%&gt;%</span> <span class="fu">as_survey_design</span>(<span class="at">ids =</span> dnum, <span class="at">strata =</span> stype, <span class="at">weights =</span>pw, <span class="at">nest =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p>Examples from <code>srvyr</code> help documentation</p>
</div></div></section>
</section>
<section id="example" class="level1" data-background-color="#0b3954">
<h1 data-background-color="#0b3954">Example</h1>
<section id="example-anes-2024" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="example-anes-2024">Example: ANES 2024</h2>
<ul>
<li>User Guide and Codebook<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> : Section “Data Analysis, Weights, and Variance Estimation” includes information on weights and strata/cluster variables</li>
</ul>
<blockquote class="blockquote">
<p>The list below indicates which weight variable to use for different types of analyses with the full release data. In general, if any post-election data are used for an estimate (alone or in combination with pre-election data), a post-election weight variable should be used, while analyses using solely pre-election data should use a pre-election weight.</p>
</blockquote>
</section>
<section id="example-anes-2024-1" class="level2">
<h2 class="anchored" data-anchor-id="example-anes-2024-1">Example: ANES 2024</h2>
<div class="cell">
<div class="cell-output-display">
<div id="tujatyhqva" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#tujatyhqva table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#tujatyhqva thead, #tujatyhqva tbody, #tujatyhqva tfoot, #tujatyhqva tr, #tujatyhqva td, #tujatyhqva th {
  border-style: none;
}

#tujatyhqva p {
  margin: 0;
  padding: 0;
}

#tujatyhqva .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tujatyhqva .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tujatyhqva .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tujatyhqva .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tujatyhqva .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tujatyhqva .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tujatyhqva .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tujatyhqva .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tujatyhqva .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tujatyhqva .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tujatyhqva .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tujatyhqva .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tujatyhqva .gt_spanner_row {
  border-bottom-style: hidden;
}

#tujatyhqva .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tujatyhqva .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tujatyhqva .gt_from_md > :first-child {
  margin-top: 0;
}

#tujatyhqva .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tujatyhqva .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tujatyhqva .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tujatyhqva .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tujatyhqva .gt_row_group_first td {
  border-top-width: 2px;
}

#tujatyhqva .gt_row_group_first th {
  border-top-width: 2px;
}

#tujatyhqva .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tujatyhqva .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tujatyhqva .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tujatyhqva .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tujatyhqva .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tujatyhqva .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tujatyhqva .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#tujatyhqva .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tujatyhqva .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tujatyhqva .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tujatyhqva .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tujatyhqva .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tujatyhqva .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tujatyhqva .gt_left {
  text-align: left;
}

#tujatyhqva .gt_center {
  text-align: center;
}

#tujatyhqva .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tujatyhqva .gt_font_normal {
  font-weight: normal;
}

#tujatyhqva .gt_font_bold {
  font-weight: bold;
}

#tujatyhqva .gt_font_italic {
  font-style: italic;
}

#tujatyhqva .gt_super {
  font-size: 65%;
}

#tujatyhqva .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#tujatyhqva .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tujatyhqva .gt_indent_1 {
  text-indent: 5px;
}

#tujatyhqva .gt_indent_2 {
  text-indent: 10px;
}

#tujatyhqva .gt_indent_3 {
  text-indent: 15px;
}

#tujatyhqva .gt_indent_4 {
  text-indent: 20px;
}

#tujatyhqva .gt_indent_5 {
  text-indent: 25px;
}

#tujatyhqva .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#tujatyhqva div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Weight" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Weight</strong></th>
<th id="description" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Use for analysis from the…</strong></th>
<th id="cluster" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>variance PSU</strong></th>
<th id="strata" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>variance stratum</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Weight">V240101a</td>
<td class="gt_row gt_left" headers="description">Pre-election fresh in-person sample alone</td>
<td class="gt_row gt_left" headers="cluster">V240101c</td>
<td class="gt_row gt_left" headers="strata">V240101d</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Weight">V240101b</td>
<td class="gt_row gt_left" headers="description">Post-election fresh in-person sample alone</td>
<td class="gt_row gt_left" headers="cluster">V240101c</td>
<td class="gt_row gt_left" headers="strata">V240101d</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Weight">V240102a</td>
<td class="gt_row gt_left" headers="description">Pre-election fresh web sample alone</td>
<td class="gt_row gt_left" headers="cluster">V240102c</td>
<td class="gt_row gt_left" headers="strata">V240102d</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Weight">V240102b</td>
<td class="gt_row gt_left" headers="description">Post-election fresh web sample alone</td>
<td class="gt_row gt_left" headers="cluster">V240102c</td>
<td class="gt_row gt_left" headers="strata">V240102d</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Weight">V240103a</td>
<td class="gt_row gt_left" headers="description">Pre-election fresh samples (fresh in-person + fresh web)</td>
<td class="gt_row gt_left" headers="cluster">V240103c</td>
<td class="gt_row gt_left" headers="strata">V240103d</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Weight">...</td>
<td class="gt_row gt_left" headers="description">...</td>
<td class="gt_row gt_left" headers="cluster">...</td>
<td class="gt_row gt_left" headers="strata">...</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Weight">V240108a</td>
<td class="gt_row gt_left" headers="description">Pre-election full sample (fresh in-person + fresh web + panel)</td>
<td class="gt_row gt_left" headers="cluster">V240108c</td>
<td class="gt_row gt_left" headers="strata">V240108d</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Weight">V240108b</td>
<td class="gt_row gt_left" headers="description">Post-election full sample (fresh in-person + fresh web + panel)</td>
<td class="gt_row gt_left" headers="cluster">V240108c</td>
<td class="gt_row gt_left" headers="strata">V240108d</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="example-anes-2024-2" class="level2">
<h2 class="anchored" data-anchor-id="example-anes-2024-2">Example: ANES 2024</h2>
<div class="cell">
<div class="cell-output-display">
<div id="vslbczzsrl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vslbczzsrl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vslbczzsrl thead, #vslbczzsrl tbody, #vslbczzsrl tfoot, #vslbczzsrl tr, #vslbczzsrl td, #vslbczzsrl th {
  border-style: none;
}

#vslbczzsrl p {
  margin: 0;
  padding: 0;
}

#vslbczzsrl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vslbczzsrl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vslbczzsrl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vslbczzsrl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vslbczzsrl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vslbczzsrl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vslbczzsrl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vslbczzsrl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vslbczzsrl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vslbczzsrl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vslbczzsrl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vslbczzsrl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vslbczzsrl .gt_spanner_row {
  border-bottom-style: hidden;
}

#vslbczzsrl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vslbczzsrl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vslbczzsrl .gt_from_md > :first-child {
  margin-top: 0;
}

#vslbczzsrl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vslbczzsrl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vslbczzsrl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vslbczzsrl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vslbczzsrl .gt_row_group_first td {
  border-top-width: 2px;
}

#vslbczzsrl .gt_row_group_first th {
  border-top-width: 2px;
}

#vslbczzsrl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vslbczzsrl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vslbczzsrl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vslbczzsrl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vslbczzsrl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vslbczzsrl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vslbczzsrl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vslbczzsrl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vslbczzsrl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vslbczzsrl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vslbczzsrl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vslbczzsrl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vslbczzsrl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vslbczzsrl .gt_left {
  text-align: left;
}

#vslbczzsrl .gt_center {
  text-align: center;
}

#vslbczzsrl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vslbczzsrl .gt_font_normal {
  font-weight: normal;
}

#vslbczzsrl .gt_font_bold {
  font-weight: bold;
}

#vslbczzsrl .gt_font_italic {
  font-style: italic;
}

#vslbczzsrl .gt_super {
  font-size: 65%;
}

#vslbczzsrl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vslbczzsrl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vslbczzsrl .gt_indent_1 {
  text-indent: 5px;
}

#vslbczzsrl .gt_indent_2 {
  text-indent: 10px;
}

#vslbczzsrl .gt_indent_3 {
  text-indent: 15px;
}

#vslbczzsrl .gt_indent_4 {
  text-indent: 20px;
}

#vslbczzsrl .gt_indent_5 {
  text-indent: 25px;
}

#vslbczzsrl .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#vslbczzsrl div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_col_headings header">
<th id="Weight" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Weight</strong></th>
<th id="description" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Use for analysis from the…</strong></th>
<th id="cluster" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>variance PSU</strong></th>
<th id="strata" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>variance stratum</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Weight">V240101a</td>
<td class="gt_row gt_left" headers="description">Pre-election fresh in-person sample alone</td>
<td class="gt_row gt_left" headers="cluster">V240101c</td>
<td class="gt_row gt_left" headers="strata">V240101d</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Weight">V240101b</td>
<td class="gt_row gt_left" headers="description">Post-election fresh in-person sample alone</td>
<td class="gt_row gt_left" headers="cluster">V240101c</td>
<td class="gt_row gt_left" headers="strata">V240101d</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Weight">V240102a</td>
<td class="gt_row gt_left" headers="description">Pre-election fresh web sample alone</td>
<td class="gt_row gt_left" headers="cluster">V240102c</td>
<td class="gt_row gt_left" headers="strata">V240102d</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Weight">V240102b</td>
<td class="gt_row gt_left" headers="description">Post-election fresh web sample alone</td>
<td class="gt_row gt_left" headers="cluster">V240102c</td>
<td class="gt_row gt_left" headers="strata">V240102d</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Weight">V240103a</td>
<td class="gt_row gt_left" headers="description">Pre-election fresh samples (fresh in-person + fresh web)</td>
<td class="gt_row gt_left" headers="cluster">V240103c</td>
<td class="gt_row gt_left" headers="strata">V240103d</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Weight">...</td>
<td class="gt_row gt_left" headers="description">...</td>
<td class="gt_row gt_left" headers="cluster">...</td>
<td class="gt_row gt_left" headers="strata">...</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Weight">V240108a</td>
<td class="gt_row gt_left" headers="description">Pre-election full sample (fresh in-person + fresh web + panel)</td>
<td class="gt_row gt_left" headers="cluster">V240108c</td>
<td class="gt_row gt_left" headers="strata">V240108d</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Weight" style="background-color: #FF8484">V240108b</td>
<td class="gt_row gt_left" headers="description" style="background-color: #FF8484">Post-election full sample (fresh in-person + fresh web + panel)</td>
<td class="gt_row gt_left" headers="cluster" style="background-color: #FF8484">V240108c</td>
<td class="gt_row gt_left" headers="strata" style="background-color: #FF8484">V240108d</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>Post-election, full sample: Weight = <code>V240108b</code></li>
<li>Use <code>V240108c</code> for variance PSU and <code>V240108d</code> for variance stratum</li>
</ul>
</section>
<section id="example-anes-2024-syntax" class="level2">
<h2 class="anchored" data-anchor-id="example-anes-2024-syntax">Example: ANES 2024 Syntax</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>anes_des <span class="ot">&lt;-</span> anes_2024 <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">mutate</span>(<span class="at">Weight =</span> V240108b <span class="sc">/</span> <span class="fu">sum</span>(V240108b) <span class="sc">*</span> <span class="dv">232449541</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="fu">as_survey_design</span>(</span>
<span id="cb8-4"><a href="#cb8-4"></a>    <span class="at">weights =</span> Weight,</span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="at">strata =</span> V240108d,</span>
<span id="cb8-6"><a href="#cb8-6"></a>    <span class="at">ids =</span> V240108c,</span>
<span id="cb8-7"><a href="#cb8-7"></a>    <span class="at">nest =</span> <span class="cn">TRUE</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Target population: 232,449,541</li>
<li>Isabella has a blog post on calculating the population for ANES 2024 data: <a href="https://rworks.netlify.app/posts/anes2024/">https://rworks.netlify.app/posts/anes2024/</a></li>
</ul>
</section>
<section id="example-anes-2024-design" class="level2">
<h2 class="anchored" data-anchor-id="example-anes-2024-design">Example: ANES 2024 Design</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anes_des)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Stratified 1 - level Cluster Sampling design (with replacement)
With (1934) clusters.
Called via srvyr
Probabilities:
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
4.099e-06 1.734e-05 3.359e-05 4.545e-05 5.939e-05 4.075e-04 
Stratum Sizes: 
            1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22
obs        22 16 30 34 30 28 27 30 28 32 31 22 25 34 18 24 36 31 38 28 43 45
design.PSU  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2
actual.PSU  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2  2
           23 24 25 26 27 28 29 30 31 32  33 34 35 36 37 38 39 40 41 42 43
obs        49 22 40 38 47 32  8  6 12 19 306 12 13 12 10 10 11 11 13 12 13
design.PSU  2  2  2  2  2  2  2  2  2  2 306 12 13 12 10 10 11 11 13 12 13
actual.PSU  2  2  2  2  2  2  2  2  2  2 306 12 13 12 10 10 11 11 13 12 13
           44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65
obs        11 12 12 13 13  9 41 38 38 37 41 39 36 43 37 32 36 38 40 37 36 39
design.PSU 11 12 12 13 13  9 41 38 38 37 41 39 36 43 37 32 36 38 40 37 36 39
actual.PSU 11 12 12 13 13  9 41 38 38 37 41 39 36 43 37 32 36 38 40 37 36 39
           66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87
obs        41 44 42 43 42 44 44 41 44 41 42 41 42 40 39 38 51 31 45 40 47 59
design.PSU 41 44 42 43 42 44 44 41 44 41 42 41 42 40 39 38  3  2  2  2  2  2
actual.PSU 41 44 42 43 42 44 44 41 44 41 42 41 42 40 39 38  3  2  2  2  2  2
           88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106
obs        52 53 41 49 35 58 46 57 42 41 44 53  56  37  58  39  48  50  52
design.PSU  2  2  2  2  2  2  2  2  2  2  2  2   2   2   2   2   2   2   2
actual.PSU  2  2  2  2  2  2  2  2  2  2  2  2   2   2   2   2   2   2   2
           107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122
obs         57  51  33  55  44  43  36  32  28  23  31  36  34  37  29  44
design.PSU   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2
actual.PSU   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2
           123 124 125 126 127 128 129 130 131
obs         31  36  27  26  32  35  32  29  25
design.PSU   2   2   2   2   2   2   2   2   2
actual.PSU   2   2   2   2   2   2   2   2   2
Data variables:
 [1] "CaseID"                  "Weight"                 
 [3] "Stratum"                 "VarUnit"                
 [5] "InterviewMode_Pre"       "InterviewMode_Post"     
 [7] "CampaignInterest"        "VotedPres2020"          
 [9] "VotedPres2020_selection" "PartyID"                
[11] "TrustGovernment"         "TrustPeople"            
[13] "Age"                     "Education"              
[15] "RaceEth"                 "Sex"                    
[17] "Income"                  "EarlyVote"              
[19] "EarlyVoteGeneral"        "Post_Vote24"            
[21] "Pre_VotePres24"          "Post_VotePres24"        
[23] "VotedPres2024_selection" "AgeGroup"               
[25] "EducationGroup"          "Income7"                
[27] "EarlyVote2024"           "Voted2024"              
[29] "VotedPres2024"           "V240001"                
[31] "V240002a"                "V240002b"               
[33] "V240108b"                "V240108d"               
[35] "V240108c"                "V241005"                
[37] "V241103"                 "V241104"                
[39] "V241038"                 "V241221"                
[41] "V241222"                 "V241223"                
[43] "V241227x"                "V241229"                
[45] "V241234"                 "V241458x"               
[47] "V241463"                 "V241499"                
[49] "V241501x"                "V241550"                
[51] "V241566x"                "V242065"                
[53] "V241035"                 "V241036"                
[55] "V241037"                 "V242051"                
[57] "V242095x"                "V242066"                
[59] "V241039"                 "V242067"                
[61] "V242096x"               </code></pre>
</div>
</div>
</section>
<section id="national-health-and-nutrition-examination-survey-nhanes" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="national-health-and-nutrition-examination-survey-nhanes">National Health and Nutrition Examination Survey (NHANES)</h2>
<ul>
<li>Analysis weight: WTINT2YR</li>
<li>Variance Stratum: SDMVSTRA</li>
<li>Variance Primary Sampling Unit: VPSU</li>
<li>Large population</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Fill in the blank</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>nhanes_des <span class="ot">&lt;-</span> nhanes <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">as_survey_design</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">weights =</span> ___________,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">ids =</span> ___________, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">strata =</span> ___________, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">fpc =</span> ___________, </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>nhanes_des <span class="ot">&lt;-</span> nhanes <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">as_survey_design</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">weights =</span> WTINT2YR,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">ids =</span> VPSU,</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">strata =</span> SDMVSTRA,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">fpc =</span> <span class="cn">NULL</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="fragment tabswitch">

</div>
</section>
</section>
<section id="designs-with-replicate-weights" class="level1" data-background-color="#087e8b">
<h1 data-background-color="#087e8b">Designs <em>with</em> replicate weights</h1>
<section id="replicate-weights-overview" class="level2">
<h2 class="anchored" data-anchor-id="replicate-weights-overview">Replicate weights overview</h2>
<ul>
<li><p>Replicate weights are a method to estimate variability that does not rely on stratum and clusters (can assist with disclosure)</p></li>
<li><p>Common replicate weight methods</p>
<ul>
<li>Balanced repeated replication (BRR)</li>
<li>Fay’s BRR</li>
<li>Jackknife</li>
<li>Bootstrap</li>
</ul></li>
</ul>
</section>
<section id="as_survey_rep-syntax" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="as_survey_rep-syntax"><code>as_survey_rep()</code>: Syntax</h2>
<p><code>as_survey_rep()</code> creates a <code>tbl_svy</code> object that then correctly calculates weighted estimates and SEs</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">as_survey_rep</span>(</span>
<span id="cb13-2"><a href="#cb13-2"></a>  .data,</span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="at">variables =</span> <span class="cn">NULL</span>, <span class="co"># defaults to all in .data</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="at">repweights =</span> <span class="cn">NULL</span>, <span class="co"># Variables specifying the replication weights</span></span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="at">weights =</span> <span class="cn">NULL</span>, <span class="co"># Variable specifying the analytic/main weight</span></span>
<span id="cb13-6"><a href="#cb13-6"></a>  <span class="at">type =</span> <span class="fu">c</span>(</span>
<span id="cb13-7"><a href="#cb13-7"></a>    <span class="st">"BRR"</span>, <span class="st">"Fay"</span>, <span class="st">"JK1"</span>, <span class="st">"JKn"</span>, <span class="st">"bootstrap"</span>,</span>
<span id="cb13-8"><a href="#cb13-8"></a>    <span class="st">"successive-difference"</span>, <span class="st">"ACS"</span>, <span class="st">"other"</span></span>
<span id="cb13-9"><a href="#cb13-9"></a>  ), <span class="co"># Type of replication weight</span></span>
<span id="cb13-10"><a href="#cb13-10"></a>  <span class="at">combined_weights =</span> <span class="cn">TRUE</span>, <span class="co"># TRUE if repweights already include sampling weights, usually TRUE</span></span>
<span id="cb13-11"><a href="#cb13-11"></a>  <span class="at">rho =</span> <span class="cn">NULL</span>, <span class="co"># Shrinkage factor for Fay's method</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>  <span class="at">bootstrap_average =</span> <span class="cn">NULL</span>, <span class="co"># For type="bootstrap", if the bootstrap weights have been averaged, gives the number of iterations averaged over</span></span>
<span id="cb13-13"><a href="#cb13-13"></a>  <span class="at">scale =</span> <span class="cn">NULL</span>, <span class="co"># Scaling constant for variance</span></span>
<span id="cb13-14"><a href="#cb13-14"></a>  <span class="at">rscales =</span> <span class="cn">NULL</span>, <span class="co"># Scaling constants for variance</span></span>
<span id="cb13-15"><a href="#cb13-15"></a>  <span class="at">mse =</span> <span class="fu">getOption</span>(<span class="st">"survey.replicates.mse"</span>), <span class="co"># If TRUE, compute variance based around point estimates rather than mean of replicates</span></span>
<span id="cb13-16"><a href="#cb13-16"></a>  <span class="at">degf =</span> <span class="cn">NULL</span>, <span class="co"># Design degrees of freedom, otherwise calculated based on number of replicate weights</span></span>
<span id="cb13-17"><a href="#cb13-17"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="syntax-for-common-replicate-methods" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="syntax-for-common-replicate-methods">Syntax for common replicate methods</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>brr_des <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>  <span class="fu">as_survey_rep</span>(</span>
<span id="cb14-3"><a href="#cb14-3"></a>    <span class="at">weights =</span> WT,</span>
<span id="cb14-4"><a href="#cb14-4"></a>    <span class="at">repweights =</span> <span class="fu">starts_with</span>(<span class="st">"REPWT"</span>),</span>
<span id="cb14-5"><a href="#cb14-5"></a>    <span class="at">type =</span> <span class="st">"BRR"</span>,</span>
<span id="cb14-6"><a href="#cb14-6"></a>    <span class="at">mse =</span> <span class="cn">TRUE</span></span>
<span id="cb14-7"><a href="#cb14-7"></a>  )</span>
<span id="cb14-8"><a href="#cb14-8"></a></span>
<span id="cb14-9"><a href="#cb14-9"></a>fay_des <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb14-10"><a href="#cb14-10"></a>  <span class="fu">as_survey_rep</span>(</span>
<span id="cb14-11"><a href="#cb14-11"></a>    <span class="at">weights =</span> WT0,</span>
<span id="cb14-12"><a href="#cb14-12"></a>    <span class="at">repweights =</span> <span class="fu">num_range</span>(<span class="st">"WT"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>),</span>
<span id="cb14-13"><a href="#cb14-13"></a>    <span class="at">type =</span> <span class="st">"Fay"</span>,</span>
<span id="cb14-14"><a href="#cb14-14"></a>    <span class="at">mse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-15"><a href="#cb14-15"></a>    <span class="at">rho =</span> <span class="fl">0.3</span></span>
<span id="cb14-16"><a href="#cb14-16"></a>  )</span>
<span id="cb14-17"><a href="#cb14-17"></a></span>
<span id="cb14-18"><a href="#cb14-18"></a>jkn_des <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb14-19"><a href="#cb14-19"></a>  <span class="fu">as_survey_rep</span>(</span>
<span id="cb14-20"><a href="#cb14-20"></a>    <span class="at">weights =</span> WT0,</span>
<span id="cb14-21"><a href="#cb14-21"></a>    <span class="at">repweights =</span> WT1<span class="sc">:</span>WT20,</span>
<span id="cb14-22"><a href="#cb14-22"></a>    <span class="at">type =</span> <span class="st">"JKN"</span>,</span>
<span id="cb14-23"><a href="#cb14-23"></a>    <span class="at">mse =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-24"><a href="#cb14-24"></a>    <span class="at">rscales =</span> <span class="fu">rep</span>(<span class="fl">0.1</span>, <span class="dv">20</span>)</span>
<span id="cb14-25"><a href="#cb14-25"></a>  )</span>
<span id="cb14-26"><a href="#cb14-26"></a></span>
<span id="cb14-27"><a href="#cb14-27"></a>bs_des <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb14-28"><a href="#cb14-28"></a>  <span class="fu">as_survey_rep</span>(</span>
<span id="cb14-29"><a href="#cb14-29"></a>    <span class="at">weights =</span> pw,</span>
<span id="cb14-30"><a href="#cb14-30"></a>    <span class="at">repweights =</span> pw1<span class="sc">:</span>pw50,</span>
<span id="cb14-31"><a href="#cb14-31"></a>    <span class="at">type =</span> <span class="st">"bootstrap"</span>,</span>
<span id="cb14-32"><a href="#cb14-32"></a>    <span class="at">scale =</span> <span class="fl">0.02186589</span>,</span>
<span id="cb14-33"><a href="#cb14-33"></a>    <span class="at">mse =</span> <span class="cn">TRUE</span></span>
<span id="cb14-34"><a href="#cb14-34"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Note: this uses fake data and can’t be run, just syntax examples</li>
</ul>
</section>
</section>
<section id="example-1" class="level1" data-background-color="#0b3954">
<h1 data-background-color="#0b3954">Example</h1>
<section id="example-recs-2020" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="example-recs-2020">Example: RECS 2020</h2>
<ul>
<li>Using the microdata file to compute estimates and relative standard errors<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></li>
</ul>
<blockquote class="blockquote">
<p>The following instructions are examples for calculating any RECS estimate using the final weights (NWEIGHT) and the associated RSE using the replicate weights (NWEIGHT1 – NWEIGHT60).</p>
</blockquote>
<ul>
<li>Includes R syntax for {survey} package which gets us what we need for {srvyr}</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>repweights <span class="ot">&lt;-</span> <span class="fu">select</span>(RECS2020, NWEIGHT1<span class="sc">:</span>NWEIGHT60)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>RECS <span class="ot">&lt;-</span> <span class="fu">svrepdesign</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> RECS2020,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> <span class="sc">~</span>NWEIGHT,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">repweights =</span> repweights,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"JK1"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">combined.weights =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">scale =</span> (<span class="fu">ncol</span>(repweights) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="fu">ncol</span>(repweights),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">mse =</span> <span class="cn">TRUE</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-recs-2020-syntax" class="level2">
<h2 class="anchored" data-anchor-id="example-recs-2020-syntax">Example: RECS 2020 Syntax</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>recs_des <span class="ot">&lt;-</span> recs_2020 <span class="sc">%&gt;%</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>  <span class="fu">as_survey_rep</span>(</span>
<span id="cb16-3"><a href="#cb16-3"></a>    <span class="at">weight =</span> NWEIGHT, </span>
<span id="cb16-4"><a href="#cb16-4"></a>    <span class="at">repweights =</span> NWEIGHT1<span class="sc">:</span>NWEIGHT60, </span>
<span id="cb16-5"><a href="#cb16-5"></a>    <span class="at">type =</span> <span class="st">"JK1"</span>, </span>
<span id="cb16-6"><a href="#cb16-6"></a>    <span class="at">scale =</span> <span class="dv">59</span> <span class="sc">/</span> <span class="dv">60</span>, </span>
<span id="cb16-7"><a href="#cb16-7"></a>    <span class="at">mse =</span> <span class="cn">TRUE</span> </span>
<span id="cb16-8"><a href="#cb16-8"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-recs-2020-output" class="level2">
<h2 class="anchored" data-anchor-id="example-recs-2020-output">Example: RECS 2020 Output</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(recs_des) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call: Called via srvyr
Unstratified cluster jacknife (JK1) with 60 replicates and MSE variances.
Sampling variables:
  - repweights: `NWEIGHT1 + NWEIGHT2 + NWEIGHT3 + NWEIGHT4 + NWEIGHT5 +
    NWEIGHT6 + NWEIGHT7 + NWEIGHT8 + NWEIGHT9 + NWEIGHT10 + NWEIGHT11 +
    NWEIGHT12 + NWEIGHT13 + NWEIGHT14 + NWEIGHT15 + NWEIGHT16 + NWEIGHT17 +
    NWEIGHT18 + NWEIGHT19 + NWEIGHT20 + NWEIGHT21 + NWEIGHT22 + NWEIGHT23 +
    NWEIGHT24 + NWEIGHT25 + NWEIGHT26 + NWEIGHT27 + NWEIGHT28 + NWEIGHT29 +
    NWEIGHT30 + NWEIGHT31 + NWEIGHT32 + NWEIGHT33 + NWEIGHT34 + NWEIGHT35 +
    NWEIGHT36 + NWEIGHT37 + NWEIGHT38 + NWEIGHT39 + NWEIGHT40 + NWEIGHT41 +
    NWEIGHT42 + NWEIGHT43 + NWEIGHT44 + NWEIGHT45 + NWEIGHT46 + NWEIGHT47 +
    NWEIGHT48 + NWEIGHT49 + NWEIGHT50 + NWEIGHT51 + NWEIGHT52 + NWEIGHT53 +
    NWEIGHT54 + NWEIGHT55 + NWEIGHT56 + NWEIGHT57 + NWEIGHT58 + NWEIGHT59 +
    NWEIGHT60` 
  - weights: NWEIGHT 
Data variables: 
  - DOEID (dbl), ClimateRegion_BA (fct), Urbanicity (fct), Region (fct),
    REGIONC (chr), Division (fct), STATE_FIPS (chr), state_postal (fct),
    state_name (fct), HDD65 (dbl), CDD65 (dbl), HDD30YR (dbl), CDD30YR
    (dbl), HousingUnitType (fct), YearMade (ord), TOTSQFT_EN (dbl), TOTHSQFT
    (dbl), TOTCSQFT (dbl), SpaceHeatingUsed (lgl), ACUsed (lgl),
    HeatingBehavior (fct), WinterTempDay (dbl), WinterTempAway (dbl),
    WinterTempNight (dbl), ACBehavior (fct), SummerTempDay (dbl),
    SummerTempAway (dbl), SummerTempNight (dbl), NWEIGHT (dbl), NWEIGHT1
    (dbl), NWEIGHT2 (dbl), NWEIGHT3 (dbl), NWEIGHT4 (dbl), NWEIGHT5 (dbl),
    NWEIGHT6 (dbl), NWEIGHT7 (dbl), NWEIGHT8 (dbl), NWEIGHT9 (dbl),
    NWEIGHT10 (dbl), NWEIGHT11 (dbl), NWEIGHT12 (dbl), NWEIGHT13 (dbl),
    NWEIGHT14 (dbl), NWEIGHT15 (dbl), NWEIGHT16 (dbl), NWEIGHT17 (dbl),
    NWEIGHT18 (dbl), NWEIGHT19 (dbl), NWEIGHT20 (dbl), NWEIGHT21 (dbl),
    NWEIGHT22 (dbl), NWEIGHT23 (dbl), NWEIGHT24 (dbl), NWEIGHT25 (dbl),
    NWEIGHT26 (dbl), NWEIGHT27 (dbl), NWEIGHT28 (dbl), NWEIGHT29 (dbl),
    NWEIGHT30 (dbl), NWEIGHT31 (dbl), NWEIGHT32 (dbl), NWEIGHT33 (dbl),
    NWEIGHT34 (dbl), NWEIGHT35 (dbl), NWEIGHT36 (dbl), NWEIGHT37 (dbl),
    NWEIGHT38 (dbl), NWEIGHT39 (dbl), NWEIGHT40 (dbl), NWEIGHT41 (dbl),
    NWEIGHT42 (dbl), NWEIGHT43 (dbl), NWEIGHT44 (dbl), NWEIGHT45 (dbl),
    NWEIGHT46 (dbl), NWEIGHT47 (dbl), NWEIGHT48 (dbl), NWEIGHT49 (dbl),
    NWEIGHT50 (dbl), NWEIGHT51 (dbl), NWEIGHT52 (dbl), NWEIGHT53 (dbl),
    NWEIGHT54 (dbl), NWEIGHT55 (dbl), NWEIGHT56 (dbl), NWEIGHT57 (dbl),
    NWEIGHT58 (dbl), NWEIGHT59 (dbl), NWEIGHT60 (dbl), BTUEL (dbl), DOLLAREL
    (dbl), BTUNG (dbl), DOLLARNG (dbl), BTULP (dbl), DOLLARLP (dbl), BTUFO
    (dbl), DOLLARFO (dbl), BTUWOOD (dbl), TOTALBTU (dbl), TOTALDOL (dbl)
Variables: 
  [1] "DOEID"            "ClimateRegion_BA" "Urbanicity"      
  [4] "Region"           "REGIONC"          "Division"        
  [7] "STATE_FIPS"       "state_postal"     "state_name"      
 [10] "HDD65"            "CDD65"            "HDD30YR"         
 [13] "CDD30YR"          "HousingUnitType"  "YearMade"        
 [16] "TOTSQFT_EN"       "TOTHSQFT"         "TOTCSQFT"        
 [19] "SpaceHeatingUsed" "ACUsed"           "HeatingBehavior" 
 [22] "WinterTempDay"    "WinterTempAway"   "WinterTempNight" 
 [25] "ACBehavior"       "SummerTempDay"    "SummerTempAway"  
 [28] "SummerTempNight"  "NWEIGHT"          "NWEIGHT1"        
 [31] "NWEIGHT2"         "NWEIGHT3"         "NWEIGHT4"        
 [34] "NWEIGHT5"         "NWEIGHT6"         "NWEIGHT7"        
 [37] "NWEIGHT8"         "NWEIGHT9"         "NWEIGHT10"       
 [40] "NWEIGHT11"        "NWEIGHT12"        "NWEIGHT13"       
 [43] "NWEIGHT14"        "NWEIGHT15"        "NWEIGHT16"       
 [46] "NWEIGHT17"        "NWEIGHT18"        "NWEIGHT19"       
 [49] "NWEIGHT20"        "NWEIGHT21"        "NWEIGHT22"       
 [52] "NWEIGHT23"        "NWEIGHT24"        "NWEIGHT25"       
 [55] "NWEIGHT26"        "NWEIGHT27"        "NWEIGHT28"       
 [58] "NWEIGHT29"        "NWEIGHT30"        "NWEIGHT31"       
 [61] "NWEIGHT32"        "NWEIGHT33"        "NWEIGHT34"       
 [64] "NWEIGHT35"        "NWEIGHT36"        "NWEIGHT37"       
 [67] "NWEIGHT38"        "NWEIGHT39"        "NWEIGHT40"       
 [70] "NWEIGHT41"        "NWEIGHT42"        "NWEIGHT43"       
 [73] "NWEIGHT44"        "NWEIGHT45"        "NWEIGHT46"       
 [76] "NWEIGHT47"        "NWEIGHT48"        "NWEIGHT49"       
 [79] "NWEIGHT50"        "NWEIGHT51"        "NWEIGHT52"       
 [82] "NWEIGHT53"        "NWEIGHT54"        "NWEIGHT55"       
 [85] "NWEIGHT56"        "NWEIGHT57"        "NWEIGHT58"       
 [88] "NWEIGHT59"        "NWEIGHT60"        "BTUEL"           
 [91] "DOLLAREL"         "BTUNG"            "DOLLARNG"        
 [94] "BTULP"            "DOLLARLP"         "BTUFO"           
 [97] "DOLLARFO"         "BTUWOOD"          "TOTALBTU"        
[100] "TOTALDOL"        </code></pre>
</div>
</div>
</section>
<section id="american-community-survey-acs" class="level2">
<h2 class="anchored" data-anchor-id="american-community-survey-acs">American Community Survey (ACS)</h2>
<ul>
<li>Analysis weight: PWGTP</li>
<li>replicate weights: PWGTP1-PWGTP180</li>
<li>jackknife with scale adjustment of 4/80</li>
</ul>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Fill in the blank</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Solution</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="sourceCode" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>acs_des <span class="ot">&lt;-</span> acs_pums <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">as_survey_rep</span>(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">weights =</span> ___________,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">repweights =</span> ___________,</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> ___________,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">scale =</span> _________ </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="sourceCode" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>acs_des <span class="ot">&lt;-</span> acs_pums <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">as_survey_rep</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">weights =</span> PWGTP,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">repweights =</span> <span class="fu">num_range</span>(<span class="st">"PWGTP"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">80</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="st">"JK1"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">scale =</span> <span class="dv">4</span><span class="sc">/</span><span class="dv">80</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>   )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="fragment tabswitch">

</div>
</section>
<section id="tips-for-correctly-specifying" class="level2">
<h2 class="anchored" data-anchor-id="tips-for-correctly-specifying">Tips for correctly specifying</h2>
<div class="incremental">
<ul class="incremental">
<li><p>For public use datasets: <strong>Documentation, Documentation, Documentation</strong></p>
<ul class="incremental">
<li>Read through user guides</li>
<li>Search for keywords (e.g., “weight”, “strata”) in the user guides</li>
<li>Google</li>
<li>Reach out to the study contact with questions</li>
</ul></li>
<li><p>For data you create: Please provide good documentation!</p></li>
</ul>
</div>
</section>
</section>
<section id="thanks" class="level1" data-background-image="images/header.png">
<h1 data-background-image="images/header.png">Thanks!</h1>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p><a href="https://electionstudies.org/data-center/20204time-series-study/" class="uri">https://electionstudies.org/data-center/20204time-series-study/</a><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><a href="https://www.eia.gov/consumption/residential/data/2020/pdf/microdata-guide.pdf" class="uri">https://www.eia.gov/consumption/residential/data/2020/pdf/microdata-guide.pdf</a><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>